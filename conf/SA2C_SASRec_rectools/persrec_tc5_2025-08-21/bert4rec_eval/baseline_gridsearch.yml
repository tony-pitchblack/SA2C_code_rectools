gridsearch:
  enable: true
  epochs_per_run: 5
  metric: "overall.ndcg@10"
  direction: "maximize"
  n_trials: 40
  timeout_s: 0
  n_jobs: 1
  seed: 0
  n_startup_trials: 10
  pruner:
    enable: true
    n_warmup_epochs: 2
  allow_early_stopping: false
  max_steps_per_run: 0

seed: 0
dataset:
  calc_date: "2025-08-21"
  hdfs_working_prefix: "hdfs:///user/antonchernov/bert4recv1/tc5/"
  user_column: loyalty_cardholder_rk
  product_column: product_id
  state_size: 50
  use_sanity_subset: false
bert4rec_loo:
  enable: true
  val_samples_num: 20000
  test_samples_num: 20000
data: data
enable_sa2c: false
purchase_only: false

batch_size_train: 400
batch_size_val: 128
num_workers_train: 0
num_workers_val: 0
device_id: 5

limit_train_batches: 0.1
limit_val_batches: 0.2
limit_test_batches: 0.2

# tuned
lr: "float(1e-4, 1e-2, log=true)"
hidden_factor: "categorical([64, 128, 256])"
num_blocks: "categorical([1, 2, 4])"
num_heads: "categorical([1, 2, 4])"
dropout_rate: "float(0.0, 0.4)"

# fixed
epoch: 80
r_click: 0.2
r_buy: 1.0
r_negative: -0.0
discount: 0.5
neg: 10
weight: 1.0
smooth: 0.0
clip: 0.0
lr_2: 0.001

sampled_loss:
  use: false

max_steps: 0
debug: false

early_stopping_ep: 10
early_stopping_metric: ndcg@10

